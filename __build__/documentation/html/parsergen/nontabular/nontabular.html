

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Non-Tabular Parser &mdash; Genie Documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/asciinema-player.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/genie_ico.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/asciinema-player.js"></script>
        <script src="../../_static/tracker.js"></script>
        <script src="../../_static/embed_version.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Advanced" href="../advanced/index.html" />
    <link rel="prev" title="Non-Tabular parsing" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> pyATS Library: Genie
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbooks/index.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../userguide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../clean/index.html">pyATS Clean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../health/index.html">pyATS Health Check</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli/index.html">Genie Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solutions/index.html">Genie Solutions</a></li>
</ul>
<p class="caption"><span class="caption-text">Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/apis">Available APIs</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/clean">Available Clean Stages</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/models">Available Models (Conf/Ops)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/parsers">Available Parsers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/triggers">Available Triggers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/verifications">Available Verifications</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../abstract/index.html">Library Abstraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metaparser/index.html">Metaparsers</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">CLI Auto-Parser</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../README.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tabular/index.html">Tabular parsing</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Non-Tabular parsing</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">The Non-Tabular Parser</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#how-it-works">How It Works</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-specify-the-regex">How To Specify the Regex</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-to-specify-show-commands">How To Specify Show Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="#specifying-parsing-details-using-marked-up-input">Specifying parsing details using <span class="xref std std-ref">Marked Up Input</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-full-example">A Full Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#attribute-value-ordering">Attribute Value Ordering</a></li>
<li class="toctree-l4"><a class="reference internal" href="#output-generated-from-marked-up-input">Output Generated from <span class="xref std std-ref">Marked Up Input</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/index.html">Advanced</a></li>
<li class="toctree-l2"><a class="reference internal" href="../apidoc/index.html">API Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../predcore/index.html">Predicates</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap/index.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog/index.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyATS Library: Genie</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">CLI Auto-Parser</a> &raquo;</li>
        
          <li><a href="index.html">Non-Tabular parsing</a> &raquo;</li>
        
      <li>The Non-Tabular Parser</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-non-tabular-parser">
<span id="non-tabular-parsing"></span><h1>The Non-Tabular Parser<a class="headerlink" href="#the-non-tabular-parser" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">parsergen</span></code> is a generic parser for show commands. The goal is to make
it simple to create a parser for any given show command one time, and then
reuse this parser to create tests for any values found within the output.</p>
<p>The main functions of <code class="docutils literal notranslate"><span class="pre">parsergen</span></code> are:</p>
<blockquote>
<div><ul class="simple">
<li><p>Find and verify expected values in show command output.</p></li>
<li><p>Provide an OS agnostic common interface to OS specific show commands.</p></li>
<li><p>Create once (per command), use many times (throughout all of your pyATS
test suites).</p></li>
<li><p>Maintain a per command cache for fast processing.</p></li>
<li><p>Only parse the parts of the output that the user is interested in, thus
avoiding wasting precious real-time.</p></li>
</ul>
</div></blockquote>
<div class="section" id="how-it-works">
<h2>How It Works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">parsergen</span></code> tries to match a given set of data using a set of
<code class="xref py py-obj docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expressions</span></code> that describe the values found within show command
output. The main idea is to exploit the structured form of the output. The
<code class="xref py py-obj docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expression</span></code> matching is tried through a hierarchical process.</p>
<p>Consider some hypothetical output from a show command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">interface</span> <span class="n">A</span>
    <span class="n">value_1</span> <span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">value_2</span> <span class="p">:</span> <span class="mi">20</span>
    <span class="n">value_3</span> <span class="p">:</span> <span class="mi">30</span>
<span class="n">interface</span> <span class="n">B</span>
    <span class="n">value_1</span> <span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="n">value_2</span> <span class="p">:</span> <span class="mi">200</span>
    <span class="n">value_3</span> <span class="p">:</span> <span class="mi">300</span>
<span class="n">interface</span> <span class="n">C</span>
    <span class="n">value_1</span> <span class="p">:</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">value_2</span> <span class="p">:</span> <span class="mi">2000</span>
    <span class="n">value_3</span> <span class="p">:</span> <span class="mi">3000</span>
</pre></div>
</div>
<p>To access the <code class="docutils literal notranslate"><span class="pre">value_2</span></code> of interface <code class="docutils literal notranslate"><span class="pre">A</span></code> <code class="docutils literal notranslate"><span class="pre">parsergen</span></code> needs a list
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expressions</span></code> to narrow down the scope of the matching. The
order of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">regexes</span></code> in the list correspond to the order of the values in
the output.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">parsergen</span></code> has a best effort algorithm to catch false
positives.  For instance, if <code class="docutils literal notranslate"><span class="pre">value_2</span></code> is not matched for interface <code class="docutils literal notranslate"><span class="pre">B</span></code>,
<code class="docutils literal notranslate"><span class="pre">parsergen</span></code> stops the execution as it exits from the inner level.</p>
</div>
<div class="section" id="how-to-specify-the-regex">
<h2>How To Specify the Regex<a class="headerlink" href="#how-to-specify-the-regex" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please see <code class="xref py py-obj docutils literal notranslate"><span class="pre">extend_markup</span></code> and <a class="reference internal" href="#mkpgen-example"><span class="std std-ref">mkpgen</span></a> on
how to automatically generate the set of <code class="xref py py-obj docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expressions</span></code> for
any given show command.</p>
</div>
<dl class="simple">
<dt>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expression</span></code> must:</dt><dd><ul class="simple">
<li><p>Be identified by a unique key (tag) in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">regex</span></code> <code class="xref py py-obj docutils literal notranslate"><span class="pre">dictionary</span></code>.</p></li>
<li><p>Must have no more than one value extracted per line.</p></li>
</ul>
</dd>
</dl>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">regex</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;iox&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;regex1&#39;</span> <span class="p">:</span> <span class="s2">&quot;i want to access (this) value in XR&quot;</span>
    <span class="p">},</span>
    <span class="s1">&#39;nxos&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;regex1&#39;</span> <span class="p">:</span> <span class="s2">&quot;i want to access (this) value in NXOS&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To teach <code class="docutils literal notranslate"><span class="pre">parsergen</span></code> a new set of <code class="xref py py-obj docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expressions</span></code> use the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">extend</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">extend_markup</span></code> methods.</p>
</div>
<div class="section" id="how-to-specify-show-commands">
<span id="id1"></span><h2>How To Specify Show Commands<a class="headerlink" href="#how-to-specify-show-commands" title="Permalink to this headline">¶</a></h2>
<p>In order to allow for OS agnostic support, and also to allow for migration of
show command syntax, one should also teach <code class="docutils literal notranslate"><span class="pre">parsergen</span></code> about show
command syntax. To do this one creates a <code class="xref py py-obj docutils literal notranslate"><span class="pre">dictionary</span></code> that maps a user
chosen key value for the show command to the actual show command syntax for a
given OS.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">show_cmds</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;iox&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;SHOW_IP_INTF&#39;</span> <span class="p">:</span> <span class="s2">&quot;show {=ipv4} interface </span><span class="si">{}</span><span class="s2">&quot;</span>
    <span class="p">},</span>
    <span class="s1">&#39;nxos&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;SHOW_IP_INTF&#39;</span> <span class="p">:</span> <span class="s2">&quot;show {=ip} interface </span><span class="si">{}</span><span class="s2">&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above example now maps the key ‘<code class="docutils literal notranslate"><span class="pre">SHOW_IP_INTF</span></code>’ to the correct syntax for
both XR and NXOS. Additionally the command strings can contain python
<code class="xref py py-meth docutils literal notranslate"><span class="pre">str.format()</span></code> arguments. The standard python format function has been
extended to allow for specifying default values if the argument is not provided
to <code class="docutils literal notranslate"><span class="pre">parsergen</span></code>. The default values can be seen above for selecting IPv4
interfaces using <code class="docutils literal notranslate"><span class="pre">=ipv4</span></code> for XR and <code class="docutils literal notranslate"><span class="pre">=ip</span></code> for NXOS. If a default value is
not provided an empty string is substituted.  For requests involving multiple
format fields, specify a format argument of <code class="docutils literal notranslate"><span class="pre">None</span></code> to indicate this is a
placeholder for the default field value.</p>
<p>To teach parsergen a new set of show commands pass the <code class="xref py py-obj docutils literal notranslate"><span class="pre">dictionary</span></code> to
<code class="xref py py-obj docutils literal notranslate"><span class="pre">parsergen.extend</span></code>
along with the set of <code class="xref py py-obj docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expressions</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">parsergen</span></code> can render CLI commands in an OS-agnostic manner.
Here’s an example
<a class="reference download internal" download="" href="../../_downloads/7c2617372f2f8f7dcd264263c9e7ee93/cli_command_formatting_example.txt"><code class="xref download docutils literal notranslate"><span class="pre">cli_command_formatting_example.py</span></code></a>.</p>
</div>
<div class="section" id="specifying-parsing-details-using-marked-up-input">
<h2>Specifying parsing details using <a class="reference internal" href="../advanced/core.html#core-markup"><span class="std std-ref">Marked Up Input</span></a><a class="headerlink" href="#specifying-parsing-details-using-marked-up-input" title="Permalink to this headline">¶</a></h2>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expression</span></code> and show command details mentioned in previous
sections can either be specified manually, or can be autogenerated via use of a
special CLI command markup format.  Please see <a class="reference internal" href="#mkpgen-example"><span class="std std-ref">Output Generated from Marked Up Input</span></a> for an
example of what this autogenerated output looks like.</p>
</div>
<div class="section" id="a-full-example">
<h2>A Full Example<a class="headerlink" href="#a-full-example" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please ensure that all tags are defined for each marked-up value.
Do not allow the tool to infer these values from surrounding text.
Any rework arising from minor syntax changes in CLI “show” command output
from release to release is then isolated to a single parser and will not
affect user code.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please identify all parts of the router output that could
potentially change from run to run and explicitly assign markup tags.
Any untagged portions of the markup text is expected to match
the router output exactly, otherwise parse failure is expected.</p>
</div>
<p>In our full example we will create a parser for the show command <code class="docutils literal notranslate"><span class="pre">show</span>
<span class="pre">interface</span></code>. The <a class="reference internal" href="../advanced/core.html#core-markup"><span class="std std-ref">marked-up output</span></a> is placed into
a file (for example,
<a class="reference download internal" download="" href="../../_downloads/3c84688e6d2590cb38abe34f0d8edfb8/parsergen_demo_mkpg.txt"><code class="xref download docutils literal notranslate"><span class="pre">parsergen_demo_mkpg.py</span></code></a>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">genie</span> <span class="kn">import</span> <span class="n">parsergen</span> <span class="k">as</span> <span class="n">pg</span>

<span class="n">marked_up_show_interface_xrvr_output</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span><span class="se">\</span>
<span class="s1">OS: iosxr</span>

<span class="s1">CMD: show_interface_&lt;WORD&gt;</span>

<span class="s1">SHOWCMD: show interface </span><span class="si">{ifname}</span><span class="s1"></span>

<span class="s1">PREFIX: show.intf</span>

<span class="s1">ACTUAL:</span>
<span class="s1">show interface MgmtEth0/0/CPU0/0</span>
<span class="s1">Fri Mar  6 12:03:11.409 EST</span>
<span class="s1">MgmtEth0/0/CPU0/0 is up, line protocol is up</span>
<span class="s1">  Interface state transitions: 1</span>
<span class="s1">  Hardware is Management Ethernet, address is 5254.00d6.36c9 (bia 5254.00d6.36c9)</span>
<span class="s1">  Internet address is 10.30.108.132/23</span>
<span class="s1">  MTU 1514 bytes, BW 0 Kbit</span>
<span class="s1">     reliability 255/255, txload Unknown, rxload Unknown</span>
<span class="s1">  Encapsulation ARPA,</span>
<span class="s1">  Duplex unknown, 0Kb/s, unknown, link type is autonegotiation</span>
<span class="s1">  output flow control is off, input flow control is off</span>
<span class="s1">  Carrier delay (up) is 10 msec</span>
<span class="s1">  loopback not set,</span>
<span class="s1">  ARP type ARPA, ARP timeout 04:00:00</span>
<span class="s1">  Last input 00:00:00, output 00:00:48</span>
<span class="s1">  Last clearing of &quot;show interface&quot; counters never</span>
<span class="s1">  5 minute input rate 79000 bits/sec, 32 packets/sec</span>
<span class="s1">  5 minute output rate 0 bits/sec, 0 packets/sec</span>
<span class="s1">     2459211 packets input, 774707935 bytes, 0 total input drops</span>
<span class="s1">     0 drops for unrecognized upper-level protocol</span>
<span class="s1">     Received 2216135 broadcast packets, 233738 multicast packets</span>
<span class="s1">              0 runts, 0 giants, 0 throttles, 0 parity</span>
<span class="s1">     0 input errors, 0 CRC, 0 frame, 0 overrun, 0 ignored, 0 abort</span>
<span class="s1">     349 packets output, 58930 bytes, 0 total output drops</span>
<span class="s1">     Output 4 broadcast packets, 0 multicast packets</span>
<span class="s1">     0 output errors, 0 underruns, 0 applique, 0 resets</span>
<span class="s1">     0 output buffer failures, 0 output buffers swapped out</span>
<span class="s1">     1 carrier transitions</span>


<span class="s1">MARKUP:</span>
<span class="s1">show interface MgmtEth0/0/CPU0/0</span>
<span class="s1">Fri Mar  6 12:03:11.409 EST</span>
<span class="s1">XI&lt;if_name&gt;XMgmtEth0/0/CPU0/0 is XC&lt;admin_state&gt;Xup, line protocol is XW&lt;line_protocol&gt;Xup</span>
<span class="s1">  Interface state transitions: XN&lt;intf_trans&gt;X1</span>
<span class="s1">  Hardware is XXX&lt;[^,]+&gt;&lt;hardware&gt;XXXManagement Ethernet, address is XA&lt;mac_address&gt;X5254.00d6.36c9 (bia 5254.00d6.36c9)</span>
<span class="s1">  Internet address is XA&lt;ip_address&gt;X10.30.108.132/23</span>
<span class="s1">  MTU XN&lt;mtu&gt;X1514 bytes, BW XNX&lt;bw&gt;0 Kbit</span>
<span class="s1">     reliability 255/255, txload Unknown, rxload Unknown</span>
<span class="s1">  Encapsulation XW&lt;encap&gt;XARPA,</span>
<span class="s1">  Duplex unknown, 0Kb/s, unknown, link type is XW&lt;link_type&gt;Xautonegotiation</span>
<span class="s1">  output flow control is XW&lt;output_flowcontrol&gt;Xoff, input flow control is XW&lt;input_flowcontrol&gt;Xoff</span>
<span class="s1">  Carrier delay (up) is XN&lt;carrier_delay_up&gt;X10 msec</span>
<span class="s1">  loopback XXX&lt;[^,]+&gt;&lt;loopback_status&gt;XXXnot set,</span>
<span class="s1">  ARP type ARPA, ARP timeout XW&lt;arp_timeout&gt;X04:00:00</span>
<span class="s1">  Last input XT&lt;last_input&gt;X00:00:00, output XT&lt;last_output&gt;X00:00:48</span>
<span class="s1">  Last clearing of &quot;show interface&quot; counters XR&lt;last_clear_counter&gt;Xnever</span>
<span class="s1">  5 minute input rate XN&lt;input_rate_bits&gt;X79000 bits/sec, XN&lt;input_rate&gt;X32 packets/sec</span>
<span class="s1">  5 minute output rate XN&lt;output_rate_bits&gt;X0 bits/sec, XN&lt;output_rate&gt;X0 packets/sec</span>
<span class="s1">     XN&lt;input_pkts&gt;X2459211 packets input, XN&lt;input_bytes&gt;X774707935 bytes, XN&lt;input_total_drops&gt;X0 total input drops</span>
<span class="s1">     XN&lt;drops_unrec_upper_level_proto&gt;X0 drops for unrecognized upper-level protocol</span>
<span class="s1">     Received XN&lt;broadcasts&gt;X2216135 broadcast packets, XN&lt;multicasts&gt;X233738 multicast packets</span>
<span class="s1">              XN&lt;runts&gt;X0 runts, XN&lt;giants&gt;X0 giants, XN&lt;throttles&gt;X0 throttles, XN&lt;parity&gt;X0 parity</span>
<span class="s1">     XN&lt;input_errors&gt;X0 input errors, XN&lt;crc&gt;X0 CRC, XN&lt;frame&gt;X0 frame, XN&lt;overrun&gt;X0 overrun, XN&lt;ignored&gt;X0 ignored, XN&lt;abort&gt;X0 abort</span>
<span class="s1">     XN&lt;output_pkts&gt;X349 packets output, XN&lt;output_bytes&gt;X58930 bytes, XN&lt;output_total_drops&gt;X0 total output drops</span>
<span class="s1">     Output XN&lt;output_broadcast&gt;X4 broadcast packets, XN&lt;output_multicast&gt;X0 multicast packets</span>
<span class="s1">     XN&lt;output_errors&gt;X0 output errors, XN&lt;output_underruns&gt;X0 underruns, XN&lt;output_applique&gt;X0 applique, XN&lt;output_resets&gt;X0 resets</span>
<span class="s1">     XN&lt;output_buf_failures&gt;X0 output buffer failures, XN&lt;output_buf_swapped&gt;X0 output buffers swapped out</span>
<span class="s1">     XN&lt;carrier_trans&gt;X1 carrier transitions</span>
<span class="s1">&#39;&#39;&#39;</span>

<span class="n">pg</span><span class="o">.</span><span class="n">extend_markup</span><span class="p">(</span><span class="n">marked_up_show_interface_xrvr_output</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="registering-with-parsergen">
<h3>Registering With Parsergen<a class="headerlink" href="#registering-with-parsergen" title="Permalink to this headline">¶</a></h3>
<p>Now we extend the current set of <code class="xref py py-obj docutils literal notranslate"><span class="pre">regular</span> <span class="pre">expressions</span></code>
and show commands recognized by <code class="docutils literal notranslate"><span class="pre">parsergen</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">genie.parsergen.examples.pyAts</span> <span class="kn">import</span> <span class="n">parsergen_demo_mkpg</span>
</pre></div>
</div>
</div>
<div class="section" id="requesting-a-parse-and-comparison-of-select-tags">
<h3>Requesting a Parse and Comparison of Select Tags<a class="headerlink" href="#requesting-a-parse-and-comparison-of-select-tags" title="Permalink to this headline">¶</a></h3>
<p>In many cases, users are only interested in parsing select portions of the
CLI command output.</p>
<p><code class="docutils literal notranslate"><span class="pre">parsergen</span></code> offers a comparison mode which allows a list of regex tags to
be specified, along with their expected values.  A parse is done on these
tags only, and if the parsed values are not as expected, parse failure will
result.</p>
<p>Here is an example of a parse and compare operation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">device</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<span class="n">attrValPairsToCheck</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.if_name&#39;</span><span class="p">,</span>                       <span class="s1">&#39;MgmtEth0/0/CPU0/0&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.line_protocol&#39;</span><span class="p">,</span>                 <span class="s1">&#39;up&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.ip_address&#39;</span><span class="p">,</span>                    <span class="s1">&#39;10.30.108.132&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.mtu&#39;</span><span class="p">,</span>                           <span class="mi">1514</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.admin_state&#39;</span><span class="p">,</span>                   <span class="s1">&#39;up&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">pgcheck</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">oper_check</span> <span class="p">(</span>
    <span class="n">device</span><span class="p">,</span>
    <span class="p">(</span><span class="s1">&#39;show_interface_&lt;WORD&gt;&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{</span><span class="s1">&#39;ifname&#39;</span><span class="p">:</span><span class="s1">&#39;MgmtEth0/0/CPU0/0&#39;</span><span class="p">}),</span>
    <span class="n">attrValPairsToCheck</span><span class="p">,</span>
    <span class="n">refresh_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span> <span class="n">pgcheck</span><span class="o">.</span><span class="n">parse</span><span class="p">():</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parse succeeded.&quot;</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing details : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">ext_dictio</span><span class="p">[</span><span class="n">device</span><span class="o">.</span><span class="n">name</span><span class="p">]))</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parse failed.&quot;</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pgcheck</span><span class="p">))</span>
</pre></div>
</div>
<p>This API is also <span class="xref std std-ref">predicate</span>-compatible.
The above snippet can also be written as such:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">genie.parsergen.predicate</span> <span class="kn">import</span> <span class="n">PredicateTestedFalseSignal</span>

<span class="n">attrValPairsToCheck</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.if_name&#39;</span><span class="p">,</span>                       <span class="s1">&#39;MgmtEth0/0/CPU0/0&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.line_protocol&#39;</span><span class="p">,</span>                 <span class="s1">&#39;up&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.ip_address&#39;</span><span class="p">,</span>                    <span class="s1">&#39;10.30.108.132&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.mtu&#39;</span><span class="p">,</span>                           <span class="mi">1514</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.admin_state&#39;</span><span class="p">,</span>                   <span class="s1">&#39;up&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">pgCheckPred</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">oper_check</span> <span class="p">(</span>
    <span class="n">device</span><span class="p">,</span>
    <span class="p">(</span><span class="s1">&#39;show_interface_&lt;WORD&gt;&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{</span><span class="s1">&#39;ifname&#39;</span><span class="p">:</span><span class="s1">&#39;MgmtEth0/0/CPU0/0&#39;</span><span class="p">}),</span>
    <span class="n">attrValPairsToCheck</span><span class="p">,</span>
    <span class="n">refresh_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">pgCheckPred</span><span class="o">.</span><span class="n">assert_test</span><span class="p">(</span><span class="s2">&quot;Parse failed&quot;</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parse succeeded.&quot;</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing details : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">ext_dictio</span><span class="p">[</span><span class="n">device</span><span class="o">.</span><span class="n">name</span><span class="p">]))</span>

<span class="k">except</span> <span class="n">PredicateTestedFalseSignal</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="requesting-a-full-parse">
<h3>Requesting a Full Parse<a class="headerlink" href="#requesting-a-full-parse" title="Permalink to this headline">¶</a></h3>
<p>Finally we have <code class="docutils literal notranslate"><span class="pre">parsergen</span></code> generate an object for us that we can ask to
parse values from the show output.  In this case, we are asking for all
the regexp tags that contain the text <code class="docutils literal notranslate"><span class="pre">show.intf</span></code> to be parsed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">genie</span> <span class="kn">import</span> <span class="n">parsergen</span> <span class="k">as</span> <span class="n">pg</span>

<span class="n">device</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">alias</span><span class="o">=</span><span class="s1">&#39;myalias&#39;</span><span class="p">)</span>

<span class="n">attrValPairsToParse</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s1">&#39;show.intf.if_name&#39;</span><span class="p">,</span> <span class="s1">&#39;MgmtEth0/0/CPU0/0&#39;</span><span class="p">),</span>
<span class="p">]</span>
<span class="n">pgfill</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">oper_fill</span> <span class="p">(</span>
    <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
    <span class="n">show_command</span><span class="o">=</span>\
        <span class="p">(</span><span class="s1">&#39;show_interface_&lt;WORD&gt;&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{</span><span class="s1">&#39;ifname&#39;</span><span class="p">:</span><span class="s1">&#39;MgmtEth0/0/CPU0/0&#39;</span><span class="p">}),</span>
    <span class="n">attrvalpairs</span><span class="o">=</span><span class="n">attrValPairsToParse</span><span class="p">,</span>
    <span class="n">refresh_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">regex_tag_fill_pattern</span><span class="o">=</span><span class="s1">&#39;show\.intf&#39;</span><span class="p">,</span>
    <span class="n">device_conn_alias</span><span class="o">=</span><span class="s1">&#39;myalias&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">pgfill</span><span class="o">.</span><span class="n">parse</span><span class="p">()</span>
<span class="k">if</span> <span class="n">result</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test passed.  Result :&quot;</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">pg</span><span class="o">.</span><span class="n">ext_dictio</span><span class="p">[</span><span class="n">device</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parse failed. Diagnosis follows:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">pgfill</span><span class="p">))</span>
</pre></div>
</div>
<div class="section" id="skip-mode">
<h4>Skip Mode<a class="headerlink" href="#skip-mode" title="Permalink to this headline">¶</a></h4>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">oper_fill</span></code> has a <code class="xref py py-obj docutils literal notranslate"><span class="pre">skip</span></code> option that can make it possible to parse text
that contains optional lines that may or may not be present.</p>
</div>
</div>
<div class="section" id="parsing-output">
<h3>Parsing Output<a class="headerlink" href="#parsing-output" title="Permalink to this headline">¶</a></h3>
<p>Here is a sample parsing output obtained by running the command from the
previous section:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;show.intf.abort&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.admin_state&#39;</span><span class="p">:</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.arp_timeout&#39;</span><span class="p">:</span> <span class="s1">&#39;04:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.broadcasts&#39;</span><span class="p">:</span> <span class="s1">&#39;16015275&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.bw&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.carrier_delay_up&#39;</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.carrier_trans&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.crc&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.drops_unrec_upper_level_proto&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.encap&#39;</span><span class="p">:</span> <span class="s1">&#39;ARPA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.frame&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.giants&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.hardware&#39;</span><span class="p">:</span> <span class="s1">&#39;Management Ethernet&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.if_name&#39;</span><span class="p">:</span> <span class="s1">&#39;MgmtEth0/0/CPU0/0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.ignored&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.input_bytes&#39;</span><span class="p">:</span> <span class="s1">&#39;5613119704&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.input_errors&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.input_flowcontrol&#39;</span><span class="p">:</span> <span class="s1">&#39;off&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.input_pkts&#39;</span><span class="p">:</span> <span class="s1">&#39;17890219&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.input_rate&#39;</span><span class="p">:</span> <span class="s1">&#39;33&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.input_rate_bits&#39;</span><span class="p">:</span> <span class="s1">&#39;84000&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.input_total_drops&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.intf_trans&#39;</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.ip_address&#39;</span><span class="p">:</span> <span class="s1">&#39;10.30.108.132&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.last_clear_counter&#39;</span><span class="p">:</span> <span class="s1">&#39;never&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.last_input&#39;</span><span class="p">:</span> <span class="s1">&#39;00:00:00&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.last_output&#39;</span><span class="p">:</span> <span class="s1">&#39;00:00:48&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.line_protocol&#39;</span><span class="p">:</span> <span class="s1">&#39;up&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.link_type&#39;</span><span class="p">:</span> <span class="s1">&#39;autonegotiation&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.loopback_status&#39;</span><span class="p">:</span> <span class="s1">&#39;not set&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.mac_address&#39;</span><span class="p">:</span> <span class="s1">&#39;5254.00d6.36c9&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.mtu&#39;</span><span class="p">:</span> <span class="s1">&#39;1514&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.multicasts&#39;</span><span class="p">:</span> <span class="s1">&#39;1792005&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_applique&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_broadcast&#39;</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_buf_failures&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_buf_swapped&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_bytes&#39;</span><span class="p">:</span> <span class="s1">&#39;1027241&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_errors&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_flowcontrol&#39;</span><span class="p">:</span> <span class="s1">&#39;off&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_multicast&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_pkts&#39;</span><span class="p">:</span> <span class="s1">&#39;15398&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_rate&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_rate_bits&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_resets&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_total_drops&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.output_underruns&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.overrun&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.parity&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.runts&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;show.intf.throttles&#39;</span><span class="p">:</span> <span class="s1">&#39;0&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="attribute-value-ordering">
<h2>Attribute Value Ordering<a class="headerlink" href="#attribute-value-ordering" title="Permalink to this headline">¶</a></h2>
<p>When using <code class="xref py py-obj docutils literal notranslate"><span class="pre">oper_fill</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">oper_check</span></code>, ordering of (key,value) pairs is
extremely important.
Specifying (key,value) pairs in the wrong order can result in parse failure.</p>
<p>If you choose to register using <code class="xref py py-obj docutils literal notranslate"><span class="pre">extend_markup</span></code>, then subsequent (key,value)
pairs passed to <code class="xref py py-obj docutils literal notranslate"><span class="pre">oper_fill</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">oper_check</span></code> will be auto-ordered for you,
meaning that you may specify them in any order you prefer.</p>
<p>If you choose to register using <code class="xref py py-obj docutils literal notranslate"><span class="pre">extend</span></code> then you must provide an ordered
list of regexp tags if you want the auto-ordering functionality.</p>
<p>Otherwise, if you register using <code class="xref py py-obj docutils literal notranslate"><span class="pre">extend</span></code> but do not provide this ordered
list, you must adhere to a strict ordering of (key,value) pairs or face
parse failure.</p>
</div>
<div class="section" id="output-generated-from-marked-up-input">
<span id="mkpgen-example"></span><h2>Output Generated from <a class="reference internal" href="../advanced/core.html#core-markup"><span class="std std-ref">Marked Up Input</span></a><a class="headerlink" href="#output-generated-from-marked-up-input" title="Permalink to this headline">¶</a></h2>
<p>Although <code class="xref py py-obj docutils literal notranslate"><span class="pre">extend_markup</span></code> automates the production of all inputs to the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">extend</span></code> API, the user still may wish to see this intermediate output for
debugging purposes.  This is done by running the
<code class="xref download docutils literal notranslate"><span class="pre">mkpgen</span></code> script.  For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">mkpgen</span> <span class="n">examples</span><span class="o">/</span><span class="n">parsergen</span><span class="o">/</span><span class="n">pyAts</span><span class="o">/</span><span class="n">parsergen_demo_mkpg</span><span class="o">.</span><span class="n">py</span>

<span class="kn">from</span> <span class="nn">genie</span> <span class="kn">import</span> <span class="n">parsergen</span> <span class="k">as</span> <span class="n">pgen</span>
<span class="n">show_commands</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;iosxr&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;show_interface_&lt;WORD&gt;&#39;</span><span class="p">:</span> <span class="s1">&#39;show interface </span><span class="si">{ifname}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">regex</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;iosxr&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1">#</span>
        <span class="c1"># show_interface_&lt;WORD&gt; (&#39;show interface {ifname}&#39;)</span>
        <span class="c1">#</span>
        <span class="s1">&#39;show.intf.if_name&#39;</span>                       <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;([-A-Za-z0-9\._/:]+) is\s+\w+, line protocol is\s+\w+\s+&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.admin_state&#39;</span>                   <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;[-A-Za-z0-9\._/:]+ is\s+(\w+), line protocol is\s+\w+\s+&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.line_protocol&#39;</span>                 <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;[-A-Za-z0-9\._/:]+ is\s+\w+, line protocol is\s+(\w+)\s+&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.intf_trans&#39;</span>                    <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Interface state transitions:\s+(\d+)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.hardware&#39;</span>                      <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Hardware is\s+([^,]+), address is\s+[A-Fa-f0-9:\.]+ \(bia 5254.00d6.36c9\)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.mac_address&#39;</span>                   <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Hardware is\s+[^,]+, address is\s+([A-Fa-f0-9:\.]+) \(bia 5254.00d6.36c9\)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.ip_address&#39;</span>                    <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Internet address is\s+([A-Fa-f0-9:\.]+)/23&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.mtu&#39;</span>                           <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+MTU\s+(\d+) bytes, BW\s+\d+ Kbit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.bw&#39;</span>                            <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+MTU\s+\d+ bytes, BW\s+(\d+) Kbit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.encap&#39;</span>                         <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Encapsulation\s+(\w+),&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.link_type&#39;</span>                     <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Duplex unknown, 0Kb/s, unknown, link type is\s+(\w+)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_flowcontrol&#39;</span>            <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+output flow control is\s+(\w+), input flow control is\s+\w+&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.input_flowcontrol&#39;</span>             <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+output flow control is\s+\w+, input flow control is\s+(\w+)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.carrier_delay_up&#39;</span>              <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Carrier delay \(up\) is\s+(\d+) msec&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.loopback_status&#39;</span>               <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+loopback\s+([^,]+),&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.last_clear_counter&#39;</span>            <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Last clearing of &quot;show interface&quot; counters\s+([^\r\n]+)&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.input_rate_bits&#39;</span>               <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+5 minute input rate\s+(\d+) bits/sec,\s+\d+ packets/sec&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.input_rate&#39;</span>                    <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+5 minute input rate\s+\d+ bits/sec,\s+(\d+) packets/sec&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_rate_bits&#39;</span>              <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+5 minute output rate\s+(\d+) bits/sec,\s+\d+ packets/sec&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_rate&#39;</span>                   <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+5 minute output rate\s+\d+ bits/sec,\s+(\d+) packets/sec&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.input_pkts&#39;</span>                    <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+(\d+) packets input,\s+\d+ bytes,\s+\d+ total input drops&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.input_bytes&#39;</span>                   <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ packets input,\s+(\d+) bytes,\s+\d+ total input drops&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.input_total_drops&#39;</span>             <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ packets input,\s+\d+ bytes,\s+(\d+) total input drops&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.drops_unrec_upper_level_proto&#39;</span> <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+(\d+) drops for unrecognized upper-level protocol&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.broadcasts&#39;</span>                    <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Received\s+(\d+) broadcast packets,\s+\d+ multicast packets&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.multicasts&#39;</span>                    <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Received\s+\d+ broadcast packets,\s+(\d+) multicast packets&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.runts&#39;</span>                         <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+(\d+) runts,\s+\d+ giants,\s+\d+ throttles,\s+\d+ parity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.giants&#39;</span>                        <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ runts,\s+(\d+) giants,\s+\d+ throttles,\s+\d+ parity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.throttles&#39;</span>                     <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ runts,\s+\d+ giants,\s+(\d+) throttles,\s+\d+ parity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.parity&#39;</span>                        <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ runts,\s+\d+ giants,\s+\d+ throttles,\s+(\d+) parity&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.input_errors&#39;</span>                  <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+(\d+) input errors,\s+\d+ CRC,\s+\d+ frame,\s+\d+ overrun,\s+\d+ ignored,\s+\d+ abort&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.crc&#39;</span>                           <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ input errors,\s+(\d+) CRC,\s+\d+ frame,\s+\d+ overrun,\s+\d+ ignored,\s+\d+ abort&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.frame&#39;</span>                         <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ input errors,\s+\d+ CRC,\s+(\d+) frame,\s+\d+ overrun,\s+\d+ ignored,\s+\d+ abort&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.overrun&#39;</span>                       <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ input errors,\s+\d+ CRC,\s+\d+ frame,\s+(\d+) overrun,\s+\d+ ignored,\s+\d+ abort&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.ignored&#39;</span>                       <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ input errors,\s+\d+ CRC,\s+\d+ frame,\s+\d+ overrun,\s+(\d+) ignored,\s+\d+ abort&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.abort&#39;</span>                         <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ input errors,\s+\d+ CRC,\s+\d+ frame,\s+\d+ overrun,\s+\d+ ignored,\s+(\d+) abort&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_pkts&#39;</span>                   <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+(\d+) packets output,\s+\d+ bytes,\s+\d+ total output drops&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_bytes&#39;</span>                  <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ packets output,\s+(\d+) bytes,\s+\d+ total output drops&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_total_drops&#39;</span>            <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ packets output,\s+\d+ bytes,\s+(\d+) total output drops&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_broadcast&#39;</span>              <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Output\s+(\d+) broadcast packets,\s+\d+ multicast packets&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_multicast&#39;</span>              <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+Output\s+\d+ broadcast packets,\s+(\d+) multicast packets&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_errors&#39;</span>                 <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+(\d+) output errors,\s+\d+ underruns,\s+\d+ applique,\s+\d+ resets&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_underruns&#39;</span>              <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ output errors,\s+(\d+) underruns,\s+\d+ applique,\s+\d+ resets&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_applique&#39;</span>               <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ output errors,\s+\d+ underruns,\s+(\d+) applique,\s+\d+ resets&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_resets&#39;</span>                 <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ output errors,\s+\d+ underruns,\s+\d+ applique,\s+(\d+) resets&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_buf_failures&#39;</span>           <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+(\d+) output buffer failures,\s+\d+ output buffers swapped out&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.output_buf_swapped&#39;</span>            <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+\d+ output buffer failures,\s+(\d+) output buffers swapped out&#39;</span><span class="p">,</span>
        <span class="s1">&#39;show.intf.carrier_trans&#39;</span>                 <span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;\s+(\d+) carrier transitions&#39;</span><span class="p">,</span>

    <span class="p">},</span>
<span class="p">}</span>
<span class="n">regex_tags</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;iosxr&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="c1">#</span>
        <span class="c1"># show_interface_&lt;WORD&gt; (&#39;show interface {ifname}&#39;)</span>
        <span class="c1">#</span>
        <span class="s1">&#39;show.intf.if_name&#39;</span>                       <span class="p">,</span>
        <span class="s1">&#39;show.intf.admin_state&#39;</span>                   <span class="p">,</span>
        <span class="s1">&#39;show.intf.line_protocol&#39;</span>                 <span class="p">,</span>
        <span class="s1">&#39;show.intf.intf_trans&#39;</span>                    <span class="p">,</span>
        <span class="s1">&#39;show.intf.hardware&#39;</span>                      <span class="p">,</span>
        <span class="s1">&#39;show.intf.mac_address&#39;</span>                   <span class="p">,</span>
        <span class="s1">&#39;show.intf.ip_address&#39;</span>                    <span class="p">,</span>
        <span class="s1">&#39;show.intf.mtu&#39;</span>                           <span class="p">,</span>
        <span class="s1">&#39;show.intf.bw&#39;</span>                            <span class="p">,</span>
        <span class="s1">&#39;show.intf.encap&#39;</span>                         <span class="p">,</span>
        <span class="s1">&#39;show.intf.link_type&#39;</span>                     <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_flowcontrol&#39;</span>            <span class="p">,</span>
        <span class="s1">&#39;show.intf.input_flowcontrol&#39;</span>             <span class="p">,</span>
        <span class="s1">&#39;show.intf.carrier_delay_up&#39;</span>              <span class="p">,</span>
        <span class="s1">&#39;show.intf.loopback_status&#39;</span>               <span class="p">,</span>
        <span class="s1">&#39;show.intf.last_clear_counter&#39;</span>            <span class="p">,</span>
        <span class="s1">&#39;show.intf.input_rate_bits&#39;</span>               <span class="p">,</span>
        <span class="s1">&#39;show.intf.input_rate&#39;</span>                    <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_rate_bits&#39;</span>              <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_rate&#39;</span>                   <span class="p">,</span>
        <span class="s1">&#39;show.intf.input_pkts&#39;</span>                    <span class="p">,</span>
        <span class="s1">&#39;show.intf.input_bytes&#39;</span>                   <span class="p">,</span>
        <span class="s1">&#39;show.intf.input_total_drops&#39;</span>             <span class="p">,</span>
        <span class="s1">&#39;show.intf.drops_unrec_upper_level_proto&#39;</span> <span class="p">,</span>
        <span class="s1">&#39;show.intf.broadcasts&#39;</span>                    <span class="p">,</span>
        <span class="s1">&#39;show.intf.multicasts&#39;</span>                    <span class="p">,</span>
        <span class="s1">&#39;show.intf.runts&#39;</span>                         <span class="p">,</span>
        <span class="s1">&#39;show.intf.giants&#39;</span>                        <span class="p">,</span>
        <span class="s1">&#39;show.intf.throttles&#39;</span>                     <span class="p">,</span>
        <span class="s1">&#39;show.intf.parity&#39;</span>                        <span class="p">,</span>
        <span class="s1">&#39;show.intf.input_errors&#39;</span>                  <span class="p">,</span>
        <span class="s1">&#39;show.intf.crc&#39;</span>                           <span class="p">,</span>
        <span class="s1">&#39;show.intf.frame&#39;</span>                         <span class="p">,</span>
        <span class="s1">&#39;show.intf.overrun&#39;</span>                       <span class="p">,</span>
        <span class="s1">&#39;show.intf.ignored&#39;</span>                       <span class="p">,</span>
        <span class="s1">&#39;show.intf.abort&#39;</span>                         <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_pkts&#39;</span>                   <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_bytes&#39;</span>                  <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_total_drops&#39;</span>            <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_broadcast&#39;</span>              <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_multicast&#39;</span>              <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_errors&#39;</span>                 <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_underruns&#39;</span>              <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_applique&#39;</span>               <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_resets&#39;</span>                 <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_buf_failures&#39;</span>           <span class="p">,</span>
        <span class="s1">&#39;show.intf.output_buf_swapped&#39;</span>            <span class="p">,</span>
        <span class="s1">&#39;show.intf.carrier_trans&#39;</span>                 <span class="p">,</span>

    <span class="p">],</span>
<span class="p">}</span>
<span class="n">pgen</span><span class="o">.</span><span class="n">extend</span> <span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">show_commands</span><span class="p">,</span> <span class="n">regex_tags</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../advanced/index.html" class="btn btn-neutral float-right" title="Advanced" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Non-Tabular parsing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Cisco Systems Inc.
      <span class="lastupdated">
        Last updated on Dec 22, 2020.
      </span>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>