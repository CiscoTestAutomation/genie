

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Concept &mdash; Genie Documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/asciinema-player.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/genie_ico.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/asciinema-player.js"></script>
        <script src="../_static/tracker.js"></script>
        <script src="../_static/embed_version.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Lookup Class" href="lookup_class.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> pyATS Library: Genie
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cookbooks/index.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userguide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../clean/index.html">pyATS Clean</a></li>
<li class="toctree-l1"><a class="reference internal" href="../health/index.html">pyATS Health Check</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Genie Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../solutions/index.html">Genie Solutions</a></li>
</ul>
<p class="caption"><span class="caption-text">Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/apis">Available APIs</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/clean">Available Clean Stages</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/models">Available Models (Conf/Ops)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/parsers">Available Parsers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/triggers">Available Triggers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/verifications">Available Verifications</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Docs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Library Abstraction</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Concept</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#abstraction-enabled-package">Abstraction-Enabled Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#abstraction-tokens">Abstraction Tokens</a></li>
<li class="toctree-l3"><a class="reference internal" href="#abstraction-mechanism">Abstraction Mechanism</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-algorithm">Search Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#token-builder">Token Builder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="lookup_class.html">Lookup Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="lookup_decorator.html">Lookup Decorator</a></li>
<li class="toctree-l2"><a class="reference internal" href="lookup_decorator.html#lookup-from-device-decorator">Lookup From Device Decorator</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html">Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="apidoc.html">API Docs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../metaparser/index.html">Metaparsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parsergen/index.html">CLI Auto-Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../predcore/index.html">Predicates</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roadmap/index.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyATS Library: Genie</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Library Abstraction</a> &raquo;</li>
        
      <li>Concept</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="concept">
<span id="abstraction-concepts"></span><h1>Concept<a class="headerlink" href="#concept" title="Permalink to this headline">¶</a></h1>
<div class="sidebar">
<p class="sidebar-title">Helpful Reading</p>
<ul class="simple">
<li><p><a class="reference external" href="http://docs.python.org/3/tutorial/modules.html#packages">Python Modules</a></p></li>
<li><p><a class="reference external" href="http://docs.python.org/3/tutorial/modules.html">Python Packages</a></p></li>
<li><p><a class="reference external" href="http://docs.python.org/3/reference/import.html">Python Import System</a></p></li>
</ul>
</div>
<p><code class="docutils literal notranslate"><span class="pre">abstract</span></code> package is built upon the principle of dynamically looking up and
calling the right set of classes/functions/methods based on <em>requirements</em>.
These requirements are defined in each <strong>abstraction enabled package</strong> in the
form of <strong>tokens</strong>.</p>
<div class="section" id="abstraction-enabled-package">
<span id="abstraction-pkg"></span><h2>Abstraction-Enabled Package<a class="headerlink" href="#abstraction-enabled-package" title="Permalink to this headline">¶</a></h2>
<p>An abstracton-enabled package is simply any regular Python package declared to
be abstraction-compatible using the <code class="docutils literal notranslate"><span class="pre">abstract.declare_package()</span></code> API. Beyond
that, an abstraction-enabled package behaves no differently than any other
standard Python modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   abstraction-enabled package example</span>

<span class="c1"># assuming the following directory structure</span>
<span class="c1">#   my_package/</span>
<span class="c1">#   |</span>
<span class="c1">#   |-- __init__.py</span>
<span class="c1">#   |</span>
<span class="c1">#   `-- &lt;other files/dirs&gt;</span>

<span class="c1"># declare abstraction-package at the top of my_package/__init__.py</span>
<span class="kn">from</span> <span class="nn">genie</span> <span class="kn">import</span> <span class="n">abstract</span>
<span class="n">abstract</span><span class="o">.</span><span class="n">declare_package</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Note</span>
<span class="c1"># ----</span>
<span class="c1">#</span>
<span class="c1">#   - the above is equivalent to:</span>
<span class="c1">#       from abstract import declare_package</span>
<span class="c1">#       declare_package(__name__)</span>
<span class="c1">#</span>
<span class="c1">#   - __name__ is the name of this module</span>
</pre></div>
</div>
<p>The call to <code class="docutils literal notranslate"><span class="pre">abstract.declare_package(__name__)</span></code> internally
flags the given module to be an abstraction package. This is a mandatory step
when creating a module to be abstraction-compatible, and does not change the
behavior of how this package normally behaves.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   an abstraction-enabled package is just like any other package</span>

<span class="c1"># you can import it</span>
<span class="kn">import</span> <span class="nn">my_package</span>

<span class="c1"># you can import submodules/classes/functions from it</span>
<span class="kn">from</span> <span class="nn">my_package</span> <span class="kn">import</span> <span class="n">sub_module</span>
<span class="kn">from</span> <span class="nn">my_package</span> <span class="kn">import</span> <span class="n">your_class</span>
<span class="kn">from</span> <span class="nn">my_package.sub_module</span> <span class="kn">import</span> <span class="n">my_submodule_class</span>
</pre></div>
</div>
</div>
<div class="section" id="abstraction-tokens">
<span id="id1"></span><h2>Abstraction Tokens<a class="headerlink" href="#abstraction-tokens" title="Permalink to this headline">¶</a></h2>
<p>An abstraction token is simply a child-module within an abstraction-enabled
package. It is declared by calling <code class="docutils literal notranslate"><span class="pre">abstract.declare_token()</span></code> API. Similar to
the above, these are still… Python modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   abstraction-enabled package with tokens</span>

<span class="c1"># assuming the following directory sturcture</span>
<span class="c1">#   my_package/</span>
<span class="c1">#   |</span>
<span class="c1">#   |-- __init__.py</span>
<span class="c1">#   |</span>
<span class="c1">#   |-- token_one/</span>
<span class="c1">#   |   `-- __init__.py</span>
<span class="c1">#   |</span>
<span class="c1">#   `-- token_two/</span>
<span class="c1">#       |-- __init__.py</span>
<span class="c1">#       |</span>
<span class="c1">#       `-- token_two_one/</span>
<span class="c1">#           `-- __init__.py</span>

<span class="c1"># abstraction-token is declared at the top of</span>
<span class="c1">#   - my_package/token_one/__init__.py</span>
<span class="c1">#   - my_package/token_two/__init__.py</span>
<span class="c1">#   - my_package/token_two_one/__init__.py</span>
<span class="kn">from</span> <span class="nn">genie</span> <span class="kn">import</span> <span class="n">abstract</span>
<span class="n">abstract</span><span class="o">.</span><span class="n">declare_token</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

<span class="c1"># Note</span>
<span class="c1"># ----</span>
<span class="c1">#</span>
<span class="c1">#   - the above is equivalent to:</span>
<span class="c1">#       from abstract import declare_token</span>
<span class="c1">#       declare_token(__name__)</span>
<span class="c1">#</span>
<span class="c1">#   - __name__ is the name of this module</span>

<span class="c1"># keep in mind that this does not alter the nature of python modules</span>
<span class="c1"># it can still be imported</span>
<span class="kn">from</span> <span class="nn">my_package.token_one</span> <span class="kn">import</span> <span class="n">my_class</span>
<span class="kn">from</span> <span class="nn">my_package.token_two</span> <span class="kn">import</span> <span class="n">token_two_one</span>
<span class="kn">from</span> <span class="nn">my_package.token_two_one.token_two_one</span> <span class="kn">import</span> <span class="n">my_other_class</span>
</pre></div>
</div>
<p>Each abstraction token represents an alternate set of libraries, capable of
handling the differences introduced/labelled by the <strong>token</strong> name. For example,
if a package contains token <code class="docutils literal notranslate"><span class="pre">nxos</span></code>, it suggests that the libraries following
this token module is specific to Cisco NXOS.</p>
<p>In addition, tokens may be chained/nested. This allows for library tiering. For
example, if token <code class="docutils literal notranslate"><span class="pre">yang</span></code> is declared under token <code class="docutils literal notranslate"><span class="pre">nxos</span></code>, it suggests that
these libraries would be specific to Cisco NXOS’s NETCONF/YANG implementation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Tokens may carry arbitrary names. Use token naming wisely to depict
differences where you want to abstract your libraries. For more details,
refer to <a class="reference internal" href="conventions.html#abstraction-conventions"><span class="std std-ref">Conventions</span></a>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Follow PEP8 - <a class="reference external" href="http://www.python.org/dev/peps/pep-0008/#package-and-module-names">module naming convention</a>.</p>
</div>
</div>
<div class="section" id="abstraction-mechanism">
<h2>Abstraction Mechanism<a class="headerlink" href="#abstraction-mechanism" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">abstract</span></code> module works most of its magic at the Python <code class="docutils literal notranslate"><span class="pre">import</span></code> and
<code class="docutils literal notranslate"><span class="pre">getattr()</span></code> level. It does so by dissecting each lookup into three distinct
parts:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>relative path</strong>: the primary lookup path that makes the most sense from
a functional perspective. This is what the user references directly, eg:
<code class="docutils literal notranslate"><span class="pre">my_library.routing.ospf</span></code></p></li>
<li><p><strong>tokens</strong>: the list of abstraction tokens currently known by the
abstraction engine. This portion is registered through the <code class="docutils literal notranslate"><span class="pre">Lookup</span></code>
object. Eg: <code class="docutils literal notranslate"><span class="pre">iosxr</span></code>, <code class="docutils literal notranslate"><span class="pre">fretta</span></code>, <code class="docutils literal notranslate"><span class="pre">xml</span></code>.</p></li>
<li><p><strong>target</strong>: the module/class/function/variable user is looking for.</p></li>
</ul>
</div></blockquote>
<p>During runtime, the lookup engine dynamically pieces together the above
information into a list of possible candidate <strong>absolute paths</strong> (direct mapping
to python import statements). As the list of tokens is arbitrary, this candidate
list is built following the <a class="reference internal" href="#abstract-search-algorithm"><span class="std std-ref">Search Algorithm</span></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   relative path &amp; absolute path explained</span>

<span class="c1"># Given the following tokens:</span>
<span class="c1">#    - iosxe</span>
<span class="c1">#    - polaris_dev</span>
<span class="c1">#    - yang</span>
<span class="n">os</span> <span class="o">=</span> <span class="s1">&#39;iosxe&#39;</span>
<span class="n">branch</span> <span class="o">=</span> <span class="s1">&#39;polaris_dev&#39;</span>
<span class="n">context</span> <span class="o">=</span> <span class="s1">&#39;yang&#39;</span>

<span class="c1"># feed to to abstraction lookup engine.</span>
<span class="n">library</span> <span class="o">=</span> <span class="n">abstract</span><span class="o">.</span><span class="n">Lookup</span><span class="p">(</span><span class="n">os</span><span class="p">,</span> <span class="n">branch</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>

<span class="c1"># the relative call to</span>
<span class="n">library</span><span class="o">.</span><span class="n">my_package</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">routing</span><span class="o">.</span><span class="n">ospf</span><span class="o">.</span><span class="n">Ospf</span><span class="p">()</span>

<span class="c1"># could match, for example:</span>
<span class="c1">#</span>
<span class="c1">#    my_package.iosxe.config.polaris_dev.routing.ospf.yang.Ospf</span>
<span class="c1">#         |       |      |       |          |     |     |    |</span>
<span class="c1">#    abstraction  |   relative   |       relative |     |  class</span>
<span class="c1">#      package    |     path     |         path   |   token</span>
<span class="c1">#               token          token           relative</span>
<span class="c1">#                                                path</span>
<span class="c1"># which translates to:</span>
<span class="c1">#   from my_package.iosxe.config.polaris_dev.routing.ospf.yang import Ospf</span>
<span class="c1">#</span>
<span class="c1"># where</span>
<span class="c1"># -----</span>
<span class="c1">#    relative path = config, routing, ospf</span>
<span class="c1">#    tokens        = iosxe, polaris_dev, yang</span>
<span class="c1">#    target        = Ospf()</span>
</pre></div>
</div>
</div>
<div class="section" id="search-algorithm">
<span id="abstract-search-algorithm"></span><h2>Search Algorithm<a class="headerlink" href="#search-algorithm" title="Permalink to this headline">¶</a></h2>
<p>The search engine combines the user’s <strong>relative path</strong> and currently known
<strong>tokens</strong> into possible <strong>absolute paths</strong> (python module names) and searches
through them. A match occurs when an implementation is found (ie the target
exists at the candidate relative path). Otherwise, the next combination is
tried. If no target is found, a <code class="docutils literal notranslate"><span class="pre">LookupError</span></code> would be thrown.</p>
<p>As the token names are not pre-defined, the search engine orders
all tokens in a pre-defined fashion:</p>
<blockquote>
<div><ul class="simple">
<li><p>token describes a set of <em>differences</em></p></li>
<li><p>token positions are always fixed w.r.t. to its left (parent)</p></li>
<li><p>tokens on the right are more <em>specific</em> than tokens on the left</p></li>
<li><p>each token may only appear <em>once</em> in a combination</p></li>
<li><p>greedy match: more tokens matches is always better than less.</p></li>
</ul>
</div></blockquote>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Given tokens: a, b, c and d, the preferred token combination would be:

    a b c d
    a b c
    a b
    a
    (no tokens)
</pre></div>
</div>
<p>These combinations are then <em>multiplexed</em> to user’s <strong>relative path</strong> into
potential <strong>absolute paths</strong> to search for, using the following rules:</p>
<blockquote>
<div><ul class="simple">
<li><p>absolute paths must always start with the abstracted package name.</p></li>
<li><p>the order of relative path sections (words divided by <code class="docutils literal notranslate"><span class="pre">.</span></code>) must be
preserved.</p></li>
<li><p>the order of token combinations must be preserved.</p></li>
<li><p>tokens may take place before and after each relative path section, and may
appear in multiples together. (eg, <code class="docutils literal notranslate"><span class="pre">library.iosxr.google.latest.mpls</span></code>)</p></li>
<li><p>the last resort option is to try with “no token”, eg, matching the
relative path directly.</p></li>
</ul>
</div></blockquote>
<p>Combining the above rules, the ideal solution would be a multi-combinatory
mathematical function, whose search complexity is … <em>(insert math here)</em> …
exponential.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Given Package: my_pkg
Relative Path: X, Y
Tokens: a, b
Target: MyClass()

We could have the following mathmatical combinational possibilities:

    1. my_pkg.a.X.b.Y.MyClass()
    2. my_pkg.a.X.Y.b.MyClass()
    3. my_pkg.X.a.Y.b.MyClass()
    4. my_pkg.X.a.b.Y.MyClass()
    5. my_pkg.X.Y.a.b.MyClass()
    6. my_pkg.a.X.Y.MyClass()
    7. my_pkg.X.a.Y.MyClass()
    8. my_pkg.X.Y.a.MyClass()
    9. my_pkg.X.Y.MyClass()

And that&#39;s just with two tokens and two path sections!
</pre></div>
</div>
<p>The actual implementation internally is much simpler. When an an abstracted
package is defined/declared and the lookup object is created, the package and
all of its child modules are <em>recursively imported</em>. This allows the abstraction
engine to build an internal table of relative paths, their available token
combinations learnt from the import and its corresponding module. This reduced
<strong>relative path + tokens</strong> relationship effectively simplies the above
brute-force search algorithm into an <code class="docutils literal notranslate"><span class="pre">O(n)</span></code> lookup, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number
of tokens.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Pseudo Lookup Table
===================

Relative Path            Tokens Combos           Corresponding Module
-------------            -------------           --------------------
     X.Y                      a, b                     X.a.Y.b
     X.Y                      a                        X.a.Y
     X.Y                      None                     X.Y

(shown in order of preference, from top down)
</pre></div>
</div>
<p>This algorithm limits to only dealing with what’s been defined in the user
library, instead of going through all possible permutations of <strong>relative path</strong>
and <strong>tokens</strong>. The system assumes that it is unlikely for users to make
redundant declarations, such as defining both <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">X.a.Y.b</span> <span class="pre">import</span> <span class="pre">target</span></code> and
<code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">X.a.b.Y</span> <span class="pre">import</span> <span class="pre">target</span></code> within the same library.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The learning process safeguards against these redundant scenarios.</p>
</div>
</div>
<div class="section" id="token-builder">
<span id="id2"></span><h2>Token Builder<a class="headerlink" href="#token-builder" title="Permalink to this headline">¶</a></h2>
<p>The token builder is a simple function that implements the token permutation
portion of the <a class="reference internal" href="#abstract-search-algorithm"><span class="std std-ref">Search Algorithm</span></a>. The default token builder is
available as <code class="docutils literal notranslate"><span class="pre">abstract.magic.default_builder()</span></code>.</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">default_builder Argument List</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Argument</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">tokens</span></code></p></td>
<td><p>list of tokens to permute</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mandatory</span></code></p></td>
<td><p>list of tokens that must be used</p></td>
</tr>
</tbody>
</table>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example</span>
<span class="c1"># -------</span>
<span class="c1">#</span>
<span class="c1">#   pseudo code demonstrating the behavior of default token builder</span>

<span class="kn">from</span> <span class="nn">abstract.magic</span> <span class="kn">import</span> <span class="n">default_builder</span>

<span class="c1"># without any mandatory tokens</span>
<span class="n">default_builder</span><span class="p">(</span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nxos&#39;</span><span class="p">,</span> <span class="s1">&#39;n7k&#39;</span><span class="p">,</span> <span class="s1">&#39;c7003&#39;</span><span class="p">,</span> <span class="s1">&#39;yang&#39;</span><span class="p">,</span> <span class="s1">&#39;R8_1&#39;</span><span class="p">])</span>
<span class="c1"># [(&#39;nxos&#39;, &#39;n7k&#39;, &#39;c7003&#39;, &#39;yang&#39;, &#39;R8_1&#39;),</span>
<span class="c1">#  (&#39;nxos&#39;, &#39;n7k&#39;, &#39;c7003&#39;, &#39;yang&#39;),</span>
<span class="c1">#  (&#39;nxos&#39;, &#39;n7k&#39;, &#39;c7003&#39;),</span>
<span class="c1">#  (&#39;nxos&#39;, &#39;n7k&#39;),</span>
<span class="c1">#  (&#39;nxos&#39;,),</span>
<span class="c1">#  ()]</span>

<span class="c1"># a mandatory token is one that MUST be used in the search</span>
<span class="n">default_builder</span><span class="p">(</span><span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;nxos&#39;</span><span class="p">,</span> <span class="s1">&#39;n7k&#39;</span><span class="p">,</span> <span class="s1">&#39;c7003&#39;</span><span class="p">,</span> <span class="s1">&#39;yang&#39;</span><span class="p">,</span> <span class="s1">&#39;R8_1&#39;</span><span class="p">],</span>
                <span class="n">mandatory</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;yang&#39;</span><span class="p">])</span>
<span class="c1"># [(&#39;nxos&#39;, &#39;n7k&#39;, &#39;c7003&#39;, &#39;yang&#39;, &#39;R8_1&#39;),</span>
<span class="c1">#  (&#39;nxos&#39;, &#39;n7k&#39;, &#39;c7003&#39;, &#39;yang&#39;),</span>
<span class="c1">#  (&#39;nxos&#39;, &#39;n7k&#39;, &#39;yang&#39;),</span>
<span class="c1">#  (&#39;nxos&#39;, &#39;yang&#39;),</span>
<span class="c1">#  (&#39;yang&#39;,)]</span>
</pre></div>
</div>
<p>In essence, the “tokens” input parameter to the builder is a reflection of
the actual, longest possible chain of tokens under any given relative path. If
no target is found at this token/relative path combination, the next, reduced
set of tokens is tried. This reduction mechanism always reduces from the right.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">mandatory</span></code> input argument when you absolutely require some tokens to
be present in any token permutations during abstraction. This can be useful when
you do not want the system to automatically fallback using the above logic and
remove it. This ensures the proper “set” of libraries is picked.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="lookup_class.html" class="btn btn-neutral float-right" title="Lookup Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Cisco Systems Inc.
      <span class="lastupdated">
        Last updated on Dec 22, 2020.
      </span>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>