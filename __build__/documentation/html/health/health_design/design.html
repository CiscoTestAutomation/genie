

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Design &mdash; Genie Documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/asciinema-player.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/genie_ico.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/asciinema-player.js"></script>
        <script src="../../_static/tracker.js"></script>
        <script src="../../_static/embed_version.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Usage" href="../health_usage/usage.html" />
    <link rel="prev" title="Installation" href="../health_installation/installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> pyATS Library: Genie
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cookbooks/index.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../userguide/index.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../clean/index.html">pyATS Clean</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">pyATS Health Check</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../health_installation/installation.html">Installation</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyats-health-check-yaml">pyATS Health Check yaml</a></li>
<li class="toctree-l3"><a class="reference internal" href="#processor-key-in-yaml">processor key in YAML</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reconnect-feature">reconnect feature</a></li>
<li class="toctree-l3"><a class="reference internal" href="#selecting-testcase-section">Selecting Testcase/Section</a></li>
<li class="toctree-l3"><a class="reference internal" href="#result-propagation">Result propagation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-platforms-for-pyats-health-check">Supported Platforms for pyATS Health Check</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../health_usage/usage.html">Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../cli/index.html">Genie Command Line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../solutions/index.html">Genie Solutions</a></li>
</ul>
<p class="caption"><span class="caption-text">Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/apis">Available APIs</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/clean">Available Clean Stages</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/models">Available Models (Conf/Ops)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/parsers">Available Parsers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/triggers">Available Triggers</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/verifications">Available Verifications</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../abstract/index.html">Library Abstraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../metaparser/index.html">Metaparsers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../parsergen/index.html">CLI Auto-Parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../predcore/index.html">Predicates</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap/index.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog/index.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pyATS Library: Genie</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">pyATS Health Check</a> &raquo;</li>
        
      <li>Design</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="design">
<h1>Design<a class="headerlink" href="#design" title="Permalink to this headline">¶</a></h1>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyATS</span> <span class="pre">Health</span> <span class="pre">Check</span></code> is highly flexible and extendable. One of the biggest advantage is, leveraging Quick Trigger(Blitz) style YAML format. Whatever can be possible in pyATS Health Check as long as it’s supported/implemented with Blitz way.</p>
<p>Develop testcase(trigger-datafile) with Blitz and develop pyATS Health Check yaml with same way! It’s very straight forward and very quick to start pyATS Health Check!</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the detail of Quick Trigger (Blitz) <a class="reference external" href="https://pubhub.devnetcloud.com/media/pyats-development-guide/docs/writeblitz/writeblitz.html">Quick Trigger (Blitz)</a></p>
</div>
<div class="section" id="pyats-health-check-yaml">
<h2>pyATS Health Check yaml<a class="headerlink" href="#pyats-health-check-yaml" title="Permalink to this headline">¶</a></h2>
<p>Here is the pyATS Health Check yaml. It’s almost same with <code class="xref py py-obj docutils literal notranslate"><span class="pre">Blitz</span></code>! There are a few consideration to run it as pyATS Health Check. All the things are written as below comments in the yaml. If no comments, it means these items are exact same with <code class="xref py py-obj docutils literal notranslate"><span class="pre">Blitz</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># testcase name should be `pyats_health_processors`</span>
<span class="nt">pyats_health_processors</span><span class="p">:</span>
  <span class="nt">groups</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&quot;test&quot;</span><span class="p p-Indicator">]</span>
  <span class="c1"># specify pyATS Health Check class instead of Blitz one</span>
  <span class="nt">source</span><span class="p">:</span>
    <span class="nt">pkg</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">genie.libs.health</span>
    <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">health.Health</span>
  <span class="nt">devices</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;uut&#39;</span><span class="p p-Indicator">]</span>
  <span class="nt">test_sections</span><span class="p">:</span>
    <span class="c1"># section name. this name will appear in Logviewer</span>
    <span class="p p-Indicator">-</span> <span class="nt">cpu</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">api</span><span class="p">:</span>
            <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">uut</span>
            <span class="c1"># `processor` is only for pyATS Health Check. Not for Blitz</span>
            <span class="c1"># Explained the detail in next section</span>
            <span class="nt">processor</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">both</span>
            <span class="c1"># `function` can be found from Genie Feature Browser</span>
            <span class="c1"># Please find the link to the page from bottom of this section</span>
            <span class="nt">function</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">get_platform_cpu_load</span>
            <span class="nt">arguments</span><span class="p">:</span>
              <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">show processes cpu</span>
              <span class="nt">processes</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;BGP</span><span class="nv"> </span><span class="s">I/O&#39;</span><span class="p p-Indicator">]</span>
    <span class="p p-Indicator">-</span> <span class="nt">memory</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">api</span><span class="p">:</span>
            <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">uut</span>
            <span class="nt">processor</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">post</span>
            <span class="nt">function</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">get_platform_memory_usage</span>
            <span class="nt">arguments</span><span class="p">:</span>
              <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">show processes memory</span>
              <span class="nt">processes</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;\*Init\*&#39;</span><span class="p p-Indicator">]</span>
            <span class="nt">include</span><span class="p">:</span>
              <span class="p p-Indicator">-</span> <span class="s">&quot;&gt;=</span><span class="nv"> </span><span class="s">10&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All available APIs and Parsers can be found here <a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/">Genie Feature Browser</a></p>
<p>Make sure you read the comments above! After this all will make sense!</p>
</div>
</div>
<div class="section" id="processor-key-in-yaml">
<h2>processor key in YAML<a class="headerlink" href="#processor-key-in-yaml" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">processor</span></code> key is introduced for pyATS Health Check. It enables you to control if the section in pyATS Health Check run as <code class="xref py py-obj docutils literal notranslate"><span class="pre">pre</span> <span class="pre">and</span> <span class="pre">post</span> <span class="pre">processor</span></code> , <code class="xref py py-obj docutils literal notranslate"><span class="pre">pre-processor</span></code>, or <code class="xref py py-obj docutils literal notranslate"><span class="pre">post-processor</span></code>.</p>
<p>Here is the list of options for <code class="xref py py-obj docutils literal notranslate"><span class="pre">processor</span></code> key in YAML and how it works.
If no <code class="xref py py-obj docutils literal notranslate"><span class="pre">processor</span></code> key in YAML is given, default is <code class="xref py py-obj docutils literal notranslate"><span class="pre">both</span></code>. So, pyATS Health Check attach the sections/actions as both pre and post processors to pyATS job.</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>processor</p></th>
<th class="head"><p>behavior</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>both (default)</p></td>
<td><p>run as pre and post processor</p></td>
</tr>
<tr class="row-odd"><td><p>pre</p></td>
<td><p>run as only pre processor</p></td>
</tr>
<tr class="row-even"><td><p>post</p></td>
<td><p>run as only post processor</p></td>
</tr>
<tr class="row-odd"><td><p>post_if_pre_execute</p></td>
<td><p>run as post processor. But it requires pre processors run before</p></td>
</tr>
</tbody>
</table>
<p>Regarding <code class="xref py py-obj docutils literal notranslate"><span class="pre">post_if_pre_execute</span></code>, sometimes post-processors need result/information from pre-processor. For example, get a route in pre-processor and verify the route in post-processor. In that case, the <code class="xref py py-obj docutils literal notranslate"><span class="pre">post_if_pre_execute</span></code> is useful to make sure pre-processor is done before.</p>
</div>
<div class="section" id="reconnect-feature">
<h2>reconnect feature<a class="headerlink" href="#reconnect-feature" title="Permalink to this headline">¶</a></h2>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reconnect</span></code> feature can be enabled in YAML, which is useful when device is crashed/reloaded. And it’s very easy to use. If you want to reconnect to device in case device is disconnected due to crash/reload/etc, just add below one line in health yaml.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">pyats_health_processors</span><span class="p">:</span>
  <span class="nt">source</span><span class="p">:</span>
    <span class="nt">pkg</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">genie.libs.health</span>
    <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">health.Health</span>
  <span class="nt">reconnect</span><span class="p">:</span> <span class="c1"># &lt;&lt;&lt;&lt;&lt;</span>
  <span class="nt">test_sections</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">traceback</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">api</span><span class="p">:</span>
</pre></div>
</div>
<p>By default, reconnect <code class="xref py py-obj docutils literal notranslate"><span class="pre">max_time</span></code> 900 secs and <code class="xref py py-obj docutils literal notranslate"><span class="pre">interval</span></code> 60 secs. <code class="xref py py-obj docutils literal notranslate"><span class="pre">max_time</span></code> is for how long pyATS Health Check is going to retry the reconnection. <code class="xref py py-obj docutils literal notranslate"><span class="pre">interval</span></code> is sleep time between attempt of reconnection when the previous one failed.</p>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">max_time</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">interval</span></code> can be configured by adding those under <code class="xref py py-obj docutils literal notranslate"><span class="pre">reconnect</span></code> section like below.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">pyats_health_processors</span><span class="p">:</span>
  <span class="nt">source</span><span class="p">:</span>
    <span class="nt">pkg</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">genie.libs.health</span>
    <span class="nt">class</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">health.Health</span>
  <span class="nt">reconnect</span><span class="p">:</span>
    <span class="nt">max_time</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">360</span> <span class="c1"># &lt;&lt;&lt;&lt;&lt;</span>
    <span class="nt">interval</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">45</span>  <span class="c1"># &lt;&lt;&lt;&lt;&lt;</span>
  <span class="nt">test_sections</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">traceback</span><span class="p">:</span>
        <span class="p p-Indicator">-</span> <span class="nt">api</span><span class="p">:</span>
</pre></div>
</div>
</div>
<div class="section" id="selecting-testcase-section">
<span id="select-testcase-section"></span><h2>Selecting Testcase/Section<a class="headerlink" href="#selecting-testcase-section" title="Permalink to this headline">¶</a></h2>
<p>pyATS Health Check processors are running before and after every testcase and section by default.</p>
<p>However, you can select which testcase and which sections to execute pyATS Health checks.</p>
<p>There are three ways to filter it. By default pyATS Health Checks run before and after every testcase and section. With the filtering you can decide where they are executed.</p>
<p>Testcase level: health-uids, provide the testcase/trigger names from Testcase/Trigger datafile. The exact name can be provided or regular expression is also supported. pyATS Health Check processors will run only for the given testcase/trigger names which match the full name or match the regex.</p>
<p>Section level: health-sections, provide the section name. The exact name can be provided or regular expression is also supported. pyATS Health Check processors will run only for the given section name which match the full name or match the regex. It will not run at the testcase level.</p>
<p>Group: health-groups, provide the group name from Testcase/Trigger datafile. The exact name can be provided or regular expression is also supported.pyATS Health Check processors will run only for the given section name which match the group or match the regex.</p>
<p>These arguments are to be provided either at</p>
<p>Cli Level:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats run job &lt;job file&gt; --testbed-file &lt;testbed file&gt; --health-file /path/to/health.yaml --health-uids &lt;testcase name&gt; --health-sections &lt;section name&gt; --health-groups &lt;testcase group&gt;
</pre></div>
</div>
<p>Health Yaml:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">test_sections</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">cpu</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">api</span><span class="p">:</span>
          <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xe</span>
          <span class="nt">function</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">get_platform_cpu_load</span>
          <span class="nt">arguments</span><span class="p">:</span>
            <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">show processes cpu</span>
            <span class="nt">processes</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;BGP</span><span class="nv"> </span><span class="s">I/O&#39;</span><span class="p p-Indicator">]</span>
          <span class="nt">include</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;&gt;=</span><span class="nv"> </span><span class="s">90&quot;</span>
          <span class="nt">health_sections</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">check_cpu</span>
          <span class="nt">health_uids</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">Test.*</span>
</pre></div>
</div>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>arguments</p></th>
<th class="head"><p>behavior</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>–health-uids</p></td>
<td><p>provide testcase/trigger name from trigger datafile. regular expression is supported. pyATS Health Check processors will run only for the given testcase/trigger names from trigger datafile which meet the regex.</p></td>
</tr>
<tr class="row-odd"><td><p>–health-sections</p></td>
<td><p>provide section name. regular expression is supported. pyATS Health Check processors will run only for the given section name which meet the regex.</p></td>
</tr>
<tr class="row-even"><td><p>–health-groups</p></td>
<td><p>provide group name from trigger datafile. regular expression is supported. pyATS Health Check processors will run only for the given group name which meet the regex</p></td>
</tr>
</tbody>
</table>
<p>All the arguments can be given to <code class="xref py py-obj docutils literal notranslate"><span class="pre">pyats</span> <span class="pre">run</span></code> command or only one or two.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats run job &lt;job file&gt; --testbed-file &lt;testbed file&gt; --health-file /path/to/health.yaml --health-uids &lt;testcase name&gt; --health-sections &lt;section name&gt; --health-groups &lt;testcase group&gt;

pyats run job &lt;job file&gt; --testbed-file &lt;testbed file&gt; --health-file /path/to/health.yaml --health-uids &lt;testcase name&gt;

pyats run job &lt;job file&gt; --testbed-file &lt;testbed file&gt; --health-file /path/to/health.yaml --health-uids &lt;testcase name&gt; --health-sections &lt;section name&gt;
</pre></div>
</div>
<p>When multiple arguments are given, the multiple arguments works as double/triple filters. It means targeted testcase/sections are narrowed down by multiple arguments.</p>
<p>Example1 (only <code class="xref py py-obj docutils literal notranslate"><span class="pre">--health-uids</span></code> for testcase <code class="xref py py-obj docutils literal notranslate"><span class="pre">Testcase1</span></code>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats run job &lt;job file&gt; --testbed-file &lt;testbed file&gt; --health-file /path/to/health.yaml --health-uids Testcase1
</pre></div>
</div>
<p>Example2 (only <code class="xref py py-obj docutils literal notranslate"><span class="pre">--health-sections</span></code> for section <code class="xref py py-obj docutils literal notranslate"><span class="pre">show_version</span></code>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats run job &lt;job file&gt; --testbed-file &lt;testbed file&gt; --health-file /path/to/health.yaml --health-sections show_version
</pre></div>
</div>
<p>Example3 (both <code class="xref py py-obj docutils literal notranslate"><span class="pre">--health-uids</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">--health-sections</span></code> for section <code class="xref py py-obj docutils literal notranslate"><span class="pre">show_version</span></code> in testcase <code class="xref py py-obj docutils literal notranslate"><span class="pre">Testcase1</span></code>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pyats run job &lt;job file&gt; --testbed-file &lt;testbed file&gt; --health-file /path/to/health.yaml --health-uids Testcase1 --health-sections show_version
</pre></div>
</div>
<p>The arguments to <code class="xref py py-obj docutils literal notranslate"><span class="pre">pyats</span> <span class="pre">run</span></code> command will be effective all the sections/actions in health yaml.</p>
<p>In health yaml, same arguments(<code class="xref py py-obj docutils literal notranslate"><span class="pre">health-uids</span></code>/<code class="xref py py-obj docutils literal notranslate"><span class="pre">health-sections</span></code>/<code class="xref py py-obj docutils literal notranslate"><span class="pre">health-groups</span></code>) can be specified in each action in health yaml. And the behavior is same with above arguments to <code class="xref py py-obj docutils literal notranslate"><span class="pre">pyats</span> <span class="pre">run</span></code> command. only difference is the arguments will be effective for the <code class="xref py py-obj docutils literal notranslate"><span class="pre">action</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">test_sections</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">cpu</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">api</span><span class="p">:</span>
          <span class="nt">device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">xe</span>
          <span class="nt">function</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">get_platform_cpu_load</span>
          <span class="nt">arguments</span><span class="p">:</span>
            <span class="nt">command</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">show processes cpu</span>
            <span class="nt">processes</span><span class="p">:</span> <span class="p p-Indicator">[</span><span class="s">&#39;BGP</span><span class="nv"> </span><span class="s">I/O&#39;</span><span class="p p-Indicator">]</span>
          <span class="nt">include</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="s">&quot;&gt;=</span><span class="nv"> </span><span class="s">90&quot;</span>
          <span class="nt">health_sections</span><span class="p">:</span>
            <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">check_cpu</span>
</pre></div>
</div>
<p>In case of above, <code class="xref py py-obj docutils literal notranslate"><span class="pre">health_sections</span></code> is given to <code class="xref py py-obj docutils literal notranslate"><span class="pre">api</span></code> action. This <code class="xref py py-obj docutils literal notranslate"><span class="pre">api</span></code> action will run only for the section <code class="xref py py-obj docutils literal notranslate"><span class="pre">check_cpu</span></code> in all Testcases/Triggers.</p>
<p>This way has more flexibility because pyATS Health processors can be controlled per <code class="xref py py-obj docutils literal notranslate"><span class="pre">action</span></code> in health yaml.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When arguments to <code class="xref py py-obj docutils literal notranslate"><span class="pre">pyats</span> <span class="pre">run</span></code> command are given, the arguments will be preferred against health yaml.</p>
<p>When multiple items are given to each argument in health yaml, those multiple items will be used as <code class="xref py py-obj docutils literal notranslate"><span class="pre">OR</span></code> search</p>
</div>
</div>
<div class="section" id="result-propagation">
<h2>Result propagation<a class="headerlink" href="#result-propagation" title="Permalink to this headline">¶</a></h2>
<p>pyATS Health Check <code class="xref py py-obj docutils literal notranslate"><span class="pre">pre</span></code> processor will not affect to section result even though some of actions in pyATS Health Check don’t meet criteria in health.yaml because pyATS Health Check itself is kind of monitor/collect functions. So, pyATS Health Check shouldn’t affect the section run. Any prerequisite things need to be handled in testcase itself instead.</p>
<p>However, the pyATS Health Check <code class="xref py py-obj docutils literal notranslate"><span class="pre">pre</span></code> processor result will pass to pyATS Health Check <code class="xref py py-obj docutils literal notranslate"><span class="pre">post</span></code> processors and the result will reflect to section with <code class="xref py py-obj docutils literal notranslate"><span class="pre">post</span></code> processor result at end of the section.</p>
<p>If one of either <code class="xref py py-obj docutils literal notranslate"><span class="pre">pre</span></code> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">post</span></code> processor items is failed, the result reflect to section even though the section is passed. So that user can look into the section and pyATS <code class="xref py py-obj docutils literal notranslate"><span class="pre">pre/post</span></code> processors what happens. When reflecting pyATS Health Check processor result to section, same <code class="xref py py-obj docutils literal notranslate"><span class="pre">Results</span> <span class="pre">Rollups</span></code> occurs. Please check the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Results</span> <span class="pre">Rollups</span></code> to below note.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the detail of Results Rollups <a class="reference external" href="https://pubhub.devnetcloud.com/media/pyats/docs/results/rollup.html">Results Rollups</a></p>
</div>
</div>
<div class="section" id="supported-platforms-for-pyats-health-check">
<h2>Supported Platforms for pyATS Health Check<a class="headerlink" href="#supported-platforms-for-pyats-health-check" title="Permalink to this headline">¶</a></h2>
<p>If you can connect to it; the infra supports it. You can use any of the existing <code class="xref py py-obj docutils literal notranslate"><span class="pre">APIs</span></code>/<code class="xref py py-obj docutils literal notranslate"><span class="pre">Parsers</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See the Supported Platforms by Unicon <a class="reference external" href="https://pubhub.devnetcloud.com/media/unicon/docs/user_guide/supported_platforms.html#">Supported Platforms</a></p>
<p>See all the available APIs <a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/apis">Available Apis</a></p>
<p>See all the available Parsers <a class="reference external" href="https://pubhub.devnetcloud.com/media/genie-feature-browser/docs/#/parsers">Available Parsers</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../health_usage/usage.html" class="btn btn-neutral float-right" title="Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../health_installation/installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Cisco Systems Inc.
      <span class="lastupdated">
        Last updated on Dec 22, 2020.
      </span>

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>